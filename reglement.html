<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MTB Points — Règlement</title>
  <link rel="stylesheet" href="css/style.css" />

  <style>
    :root{
      --bg:#f4f4f4;--card:#ffffff;--text:#0f172a;--muted:#64748b;--border:#e5e7eb;--blue:#2563eb;
      --shadow:0 2px 10px rgba(0,0,0,.06);
      --shadow2:0 2px 10px rgba(0,0,0,.08);
    }
    body{margin:0;background:var(--bg);color:var(--text);font-family:Arial,Helvetica,sans-serif;}
    .header{background:var(--card);padding:14px 16px;box-shadow:var(--shadow);}
    .header h1{margin:0;font-size:20px}
    .header nav{margin-top:8px;display:flex;gap:14px;flex-wrap:wrap;align-items:center}
    .header nav a{color:var(--text);text-decoration:none;font-size:14px}
    .header nav a.active{color:var(--blue);font-weight:700}
    .lang{margin-top:10px;display:flex;gap:8px}
    .btn{padding:8px 10px;border-radius:10px;border:1px solid #cbd5e1;background:#fff;cursor:pointer}
    .wrap{max-width:980px;margin:22px auto;padding:0 16px;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px;margin:14px 0;box-shadow:var(--shadow2);}
    .toc a{display:block;text-decoration:none;color:var(--blue);padding:6px 0}
    h2{margin:0 0 10px 0;font-size:18px}
    h3{margin:14px 0 6px 0;font-size:15px}
    p,li{font-size:14px;line-height:1.6}
    ul{padding-left:18px;margin:8px 0}
    code{background:#f1f5f9;border:1px solid var(--border);border-radius:8px;padding:2px 6px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;font-size:13px}
    .muted{color:var(--muted);font-size:13px}
    .box{background:#f8fafc;border:1px solid var(--border);border-left:5px solid var(--blue);border-radius:12px;padding:12px;margin:12px 0}
    .pill{display:inline-block;background:#f1f5f9;border:1px solid var(--border);border-radius:999px;padding:5px 10px;font-size:12px;font-weight:800}
    footer{padding:26px 16px;text-align:center;color:var(--muted);font-size:13px}
  </style>
</head>

<body>
<header class="header">
  <h1>MTB Points — Règlement</h1>

  <nav>
<a href="index.html">Acceuil</a>
<a href="public-ranking.html">Classement</a>
<a href="meetings.html">Événements</a>
<a href="reglement.html">Règlement</a>
<a href="methodologie.html" class="active">Méthodologie (calcul)</a>
<a href="about.html">À propos</a>
<a href="login.html">Connexion</a>
  </nav>

  <div class="lang">
    <button class="btn" id="btnFR" type="button">FR</button>
    <button class="btn" id="btnEN" type="button">EN</button>
  </div>
</header>

<main class="wrap">

  <!-- TABLE DES MATIERES -->
  <section class="card">
    <h2>Sommaire</h2>
    <div class="toc">
      <a href="#objet">1. Objet</a>
      <a href="#definitions">2. Définitions</a>
      <a href="#eligibilite">3. Éligibilité</a>
      <a href="#mrs">4. Score Épreuve (MRS)</a>
      <a href="#points-coureur">5. Points Coureur</a>
      <a href="#classements">6. Classements</a>
      <a href="#challenge-1000">10. Challenge “MTB 1000”</a>
      <a href="#import">7. Résultats &amp; Import</a>
      <a href="#controle">8. Contrôle &amp; Modération</a>
      <a href="#litiges">9. Litiges</a>
    </div>
    <p class="muted" style="margin-top:10px;">
      Les détails de calcul (ScorePhys / ScoreTech / paramètres) sont dans :
      <a href="methodologie.html">Méthodologie (calcul)</a>.
    </p>
  </section>

  <!-- OBJET -->
  <section class="card" id="objet">
    <h2>1. Objet</h2>
    <p>
      MTB Points est un système de points destiné à évaluer la difficulté d’une épreuve VTT et à classer les cyclistes
      en fonction de leurs performances. Il s’inspire du principe des points ITRA (trail), tout en intégrant les spécificités
      du VTT (pente, terrain, sinuosité, effort).
    </p>
    <div class="box">
      <strong>Principe :</strong> une épreuve reçoit un score de difficulté (<strong>MRS</strong>). Chaque participant reçoit des points
      selon sa performance (temps) et son statut (finisher, abandon, hors délai, etc.).
    </div>
  </section>

  <!-- DEFINITIONS -->
  <section class="card" id="definitions">
    <h2>2. Définitions</h2>
    <ul>
      <li><strong>Épreuve (Race)</strong> : course individuelle (distance/format) associée ou non à un événement (meeting).</li>
      <li><strong>Événement (Meeting)</strong> : rassemblement pouvant contenir plusieurs épreuves (20 km, 30 km, 40 km…).</li>
      <li><strong>Trace GPX</strong> : fichier de parcours servant aux calculs automatiques (distance, D+, profils, scores).</li>
      <li><strong>MRS</strong> : <em>MTB Race Score</em>, score global de difficulté de l’épreuve, sur 100.</li>
      <li><strong>ScorePhys</strong> : score physique (0–100) basé sur distance, D+ et sévérité des pentes (IPB).</li>
      <li><strong>ScoreTech</strong> : score technique (0–100) basé sur sinuosité et estimation de terrain via GPX.</li>
      <li><strong>Statuts</strong> :
        <ul>
          <li><code>FIN</code> : finisher (temps valide et dans la barrière horaire)</li>
          <li><code>DNF</code> : abandon (Did Not Finish)</li>
          <li><code>DNS</code> : non-partant (Did Not Start)</li>
          <li><code>OT</code> : hors barrière horaire (Out of Time)</li>
          <li><code>DSQ</code> : disqualifié</li>
        </ul>
      </li>
    </ul>
  </section>

  <!-- ELIGIBILITE -->
  <section class="card" id="eligibilite">
    <h2>3. Éligibilité</h2>
    <ul>
      <li>Les points ne sont attribués que pour des épreuves disposant d’une date et d’une trace GPX analysable.</li>
      <li>Les résultats doivent être importés par un organisateur (ou validés par modération).</li>
      <li>Le classement est séparé par :
        <ul>
          <li>Discipline (XC, Enduro, DH, Gravel, etc.)</li>
          <li>Sexe (Hommes / Femmes)</li>
          <li>Catégorie d’âge (UCI)</li>
          <li>Type de vélo : <strong>Musculaire</strong> vs <strong>Assistance électrique</strong> (classements distincts)</li>
        </ul>
      </li>
    </ul>
  </section>

  <!-- MRS (sans méthodologie détaillée) -->
  <section class="card" id="mrs">
    <h2>4. Score Épreuve (MRS)</h2>
    <p>
      Le score global de difficulté d’une épreuve (<strong>MRS</strong>) est calculé à partir d’un score physique et d’un score technique.
      Les détails de calcul sont décrits dans la page <a href="methodologie.html">Méthodologie (calcul)</a>.
    </p>

    <div class="box">
      <strong>Niveau de l’épreuve</strong>
      <p style="margin:8px 0 0 0;">
        L’organisateur peut déclarer un niveau :
        <span class="pill">Locale</span>
        <span class="pill">Régionale</span>
        <span class="pill">Nationale</span>
        <span class="pill">Internationale</span>
      </p>
      <p class="muted" style="margin:8px 0 0 0;">
        Ce niveau peut influencer la valeur de points maximale distribuée (voir section suivante).
      </p>
    </div>
  </section>

  <!-- POINTS COUREUR -->
  <section class="card" id="points-coureur">
    <h2>5. Points Coureur</h2>
    <p>
      Chaque épreuve distribue une quantité maximale de points <strong>P<sub>e</sub></strong> (vainqueur) dérivée du MRS,
      bornée entre 0 et 200.
    </p>

    <div class="box">
      <strong>Valeur maximale (vainqueur)</strong>
      <p style="margin:8px 0;">
        <code>P_e = clamp(round(200 × (MRS/100)^1.20) × M_level, 0, 200)</code>
      </p>
      <div class="muted">
        M_level (niveau) : Locale=0.8, Régionale=1.0, Nationale=1.2, Internationale=1.5.
      </div>
    </div>

    <h3>5.1 Règle finishers / abandons</h3>
    <div class="box">
      <p style="margin:0;">
        <strong>FIN :</strong> minimum <strong>5 points</strong> par finisher.<br/>
        <strong>DNF / OT / DNS / DSQ :</strong> <strong>0 point</strong>.
      </p>
    </div>

    <h3>5.2 Attribution par performance au temps</h3>
    <p>
      Pour un finisher <em>i</em> dans une catégorie donnée (discipline/sexe/âge/type vélo), on définit :
      <code>t_i</code> = temps du coureur, et <code>t*</code> = meilleur temps (référence).
    </p>

    <div class="box">
      <code>r = t_i / t*</code><br/>
      <code>Points(i,e) = max(5, round(P_e' × r^(−k)))</code>
      <div class="muted">
        k = 3.0 (par défaut). P_e' peut intégrer un correctif de faible participation si activé.
      </div>
    </div>
  </section>

  <!-- CLASSEMENTS -->
  <section class="card" id="classements">
    <h2>6. Classements</h2>
    <p>Deux modes de classement sont proposés :</p>
    <ul>
      <li><strong>Classement glissant 24 mois</strong> (par défaut)</li>
      <li><strong>Classement par année civile</strong> (ex. 2025, 2026…)</li>
    </ul>

    <h3>6.1 Fenêtre 24 mois (Top N)</h3>
    <div class="box">
      <code>MTB_Points(i,C) = somme des Top N résultats de i dans C sur 24 mois</code>
      <div class="muted">N=5 par défaut (paramétrable).</div>
    </div>

    <h3>6.2 Classement par année</h3>
    <div class="box">
      <code>MTB_Points_Year(i,C,Y) = somme des Top N résultats de i dans C sur l’année Y</code>
    </div>

    <p class="muted">
      Les classements sont distincts pour <strong>musculaire</strong> et <strong>assistance électrique</strong>.
    </p>
  </section>

<!-- CHALLENGE MTB 1000 -->
<section class="card" id="challenge-1000">
  <h2>10. Challenge “MTB 1000”</h2>

  <p>
    Le challenge <strong>MTB 1000</strong> vise à récompenser la régularité et la performance sur une période donnée.
    Il est calculé sur le même principe que les classements (fenêtre glissante).
  </p>

  <div class="box">
    <strong>Définition</strong>
    <p style="margin:8px 0 0 0;">
      Un coureur valide le statut <strong>MTB 1000</strong> lorsqu’il atteint <strong>1000 points</strong> sur une fenêtre glissante
      de <strong>24 mois</strong>, dans une <strong>discipline</strong> et un <strong>type de vélo</strong> donnés.
    </p>
  </div>

  <h3>10.1 Périmètre</h3>
  <ul>
    <li>Le challenge est <strong>distinct</strong> par discipline (ex. XC / Enduro / DH / Gravel…).</li>
    <li>Le challenge est <strong>distinct</strong> par type de vélo : <strong>Musculaire</strong> et <strong>Assistance électrique</strong>.</li>
    <li>Option (recommandée) : séparé par sexe et catégorie d’âge, comme le classement principal.</li>
  </ul>

  <h3>10.2 Calcul (fenêtre 24 mois — Top N)</h3>
  <div class="box">
    <p style="margin:0 0 8px 0;">
      Le score “challenge” est la somme des <strong>Top N</strong> meilleurs résultats du coureur sur les <strong>24 derniers mois</strong>.
    </p>
    <p style="margin:0;">
      <code>ChallengePoints(i,C) = somme des Top N résultats de i dans C sur 24 mois</code><br/>
      <span class="muted">N = 5 par défaut (paramétrable). C = catégorie (discipline / sexe / âge / type vélo).</span>
    </p>
  </div>

  <h3>10.3 Condition anti-biais (minimum d’épreuves)</h3>
  <div class="box">
    <p style="margin:0;">
      Pour valider un statut, le coureur doit avoir participé à au moins
      <strong>5 épreuves distinctes</strong> dans la catégorie considérée sur la période.
      <span class="muted">(paramétrable)</span>
    </p>
  </div>

  <h3>10.4 Niveaux &amp; badges</h3>
  <p>
    MTB Points peut attribuer des niveaux (badges) visibles sur le profil et le classement :
  </p>

  <div class="box">
    <ul style="margin:0 0 0 18px;">
      <li><strong>Bronze</strong> : ≥ 300 points</li>
      <li><strong>Argent</strong> : ≥ 600 points</li>
      <li><strong>MTB 1000</strong> : ≥ 1000 points</li>
      <li><strong>Élite</strong> : ≥ 1500 points</li>
      <li><strong>Légende</strong> : ≥ 2000 points</li>
    </ul>
    <p class="muted" style="margin:10px 0 0 0;">
      Les seuils peuvent évoluer après calibration, sans effet rétroactif si souhaité.
    </p>
  </div>

  <h3>10.5 Affichage</h3>
  <ul>
    <li>Le badge est affiché sur le <strong>profil coureur</strong> et dans le <strong>classement</strong>.</li>
    <li>Une page “Hall of Fame” peut lister les coureurs ayant validé <strong>MTB 1000</strong>.</li>
  </ul>
</section>


  <!-- RESULTATS & IMPORT -->
  <section class="card" id="import">
    <h2>7. Résultats &amp; Import</h2>
    <p>
      Les résultats sont importés par l’organisateur via un fichier (CSV, et à terme XLSX).
      Les colonnes recommandées sont :
    </p>
    <ul>
      <li>Nom / Prénom (ou Nom complet)</li>
      <li>Sexe</li>
      <li>Catégorie âge</li>
      <li>Nationalité</li>
      <li>Team</li>
      <li>Type vélo (musculaire / e-bike)</li>
      <li>Temps (<code>HH:MM:SS</code>)</li>
      <li>Statut (<code>FIN/DNF/DNS/OT/DSQ</code>)</li>
    </ul>
    <div class="box">
      <strong>Règle :</strong> un temps valide implique <code>FIN</code> sauf indication contraire.
      Tout statut non-finisher entraîne 0 point.
    </div>
  </section>

  <!-- CONTROLE & MODERATION -->
  <section class="card" id="controle">
    <h2>8. Contrôle &amp; Modération</h2>
    <ul>
      <li>Un compte administrateur peut supprimer ou dépublier une épreuve en cas d’abus (fausse trace, faux résultats).</li>
      <li>Les modifications majeures (GPX, distance, D+) peuvent être journalisées et nécessiter re-calcul des scores.</li>
      <li>Les épreuves “National/International” peuvent être soumises à validation (option).</li>
      <li>Les classements musculaire et e-bike sont séparés ; toute inco
